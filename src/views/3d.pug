doctype html
html(lang="en")
    include includes/head.pug
    +seo()
    
    block styles
        style.
            .fullscreen-canvas {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 0;
            }
            
            #loading-screen {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(16, 16, 16, 0.95);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 2;
            }
            
            .loading-content {
                text-align: center;
                color: white;
            }
            
            .loading-bar-container {
                width: 200px;
                height: 4px;
                background-color: #333;
                margin: 20px auto;
                border-radius: 2px;
            }
            
            #loading-bar {
                height: 100%;
                width: 0%;
                background-color: #69b3a2;
                border-radius: 2px;
                transition: width 0.3s ease;
            }
            
            #book-viewer {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 80%;
                max-width: 800px;
                height: 80%;
                background-color: rgba(16, 16, 16, 0.9);
                border-radius: 5px;
                padding: 20px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
                z-index: 3;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }
            
            .book-content {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
            }
            
            #book-pages {
                flex: 1;
                overflow-y: auto;
                padding: 20px;
                background-color: #f5f5f5;
                color: #333;
                font-family: 'Source Code Pro', monospace;
                border-radius: 3px;
                margin-bottom: 20px;
            }
            
            .book-controls {
                display: flex;
                justify-content: space-between;
                width: 100%;
            }
            
            .hidden {
                display: none !important;
            }
            
            button {
                padding: 10px 20px;
                background-color: #69b3a2;
                color: white;
                border: none;
                border-radius: 3px;
                cursor: pointer;
                font-family: 'Lora', serif;
                transition: background-color 0.3s;
            }
            
            button:hover {
                background-color: #4a9080;
            }

    body.threejs-view
        include includes/nav.pug

        div#babylibrary3d.fullscreen-canvas
            canvas#babylonCanvas
        div#loading-screen
            div.loading-content
                h2 Loading Library of Babel in 3D...
                div.loading-bar-container
                    div#loading-bar
        div#book-viewer.hidden
            div.book-content
                div#book-pages
                div.book-controls
                    button#prev-page Prev Page
                    button#close-book Close
                    button#next-page Next Page

        include includes/footer.pug

        script(type="importmap").
            {
                "imports": {
                    "three": "https://cdn.jsdelivr.net/npm/three@0.173.0/build/three.module.js",
                    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.173.0/examples/jsm/"
                }
            }
        script(type="module", src="/js/3d-experience.js")
        script.
            // Prevent clicks on the book viewer from propagating to the canvas
            document.getElementById('book-viewer').addEventListener('click', function(event) {
                event.stopPropagation();
            }); 